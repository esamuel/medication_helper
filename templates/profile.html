{% extends "base.html" %}

{% block title %}My Profile{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h2 class="mb-0">My Profile</h2>
    </div>
    <div class="card-body">
        <form method="POST">
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="first_name" class="form-label">First Name</label>
                    <input type="text" class="form-control" id="first_name" name="first_name" 
                           value="{{ profile.first_name }}" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="last_name" class="form-label">Last Name</label>
                    <input type="text" class="form-control" id="last_name" name="last_name" 
                           value="{{ profile.last_name }}" required>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="date_of_birth" class="form-label">Date of Birth</label>
                    <input type="date" class="form-control" id="date_of_birth" name="date_of_birth" 
                           value="{{ profile.date_of_birth }}" required>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="height" class="form-label">Height (cm)</label>
                    <input type="number" step="0.1" class="form-control" id="height" name="height" 
                           value="{{ profile.height }}" required>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="weight" class="form-label">Weight (kg)</label>
                    <input type="number" step="0.1" class="form-control" id="weight" name="weight" 
                           value="{{ profile.weight }}" required>
                </div>
            </div>

            <div class="mb-3">
                <label for="blood_type" class="form-label">Blood Type</label>
                <select class="form-select" id="blood_type" name="blood_type">
                    <option value="">Select blood type</option>
                    {% for blood_type in ['A+', 'A-', 'B+', 'B-', 'AB+', 'AB-', 'O+', 'O-'] %}
                        <option value="{{ blood_type }}" {% if profile.blood_type == blood_type %}selected{% endif %}>
                            {{ blood_type }}
                        </option>
                    {% endfor %}
                </select>
            </div>

            <div class="mb-3">
                <label for="allergies" class="form-label">Allergies</label>
                <textarea class="form-control" id="allergies" name="allergies" rows="2" 
                          placeholder="List any allergies...">{{ profile.allergies }}</textarea>
            </div>

            <div class="mb-3">
                <label for="medical_conditions" class="form-label">Medical Conditions</label>
                <textarea class="form-control" id="medical_conditions" name="medical_conditions" rows="3" 
                          placeholder="List any medical conditions...">{{ profile.medical_conditions }}</textarea>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="emergency_contact_name" class="form-label">Emergency Contact Name</label>
                    <input type="text" class="form-control" id="emergency_contact_name" 
                           name="emergency_contact_name" value="{{ profile.emergency_contact_name }}">
                </div>
                <div class="col-md-6 mb-3">
                    <label for="emergency_contact_phone" class="form-label">Emergency Contact Phone</label>
                    <input type="tel" class="form-control" id="emergency_contact_phone" 
                           name="emergency_contact_phone" value="{{ profile.emergency_contact_phone }}">
                </div>
            </div>

            <div class="d-flex justify-content-between">
                <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">Back to Medications</a>
                <button type="submit" class="btn btn-primary">Save Profile</button>
            </div>
        </form>
    </div>
</div>

{% if profile.last_updated %}
<div class="text-muted mt-3 text-end">
    Last updated: {{ profile.last_updated.strftime('%Y-%m-%d %H:%M:%S') }}
</div>
{% endif %}
{% endblock %}
